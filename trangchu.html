<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Há»‡ thá»‘ng Quáº£n lÃ½ PhÃ²ng trá» - XuÃ¢n CÃ´ng</title>
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/home.css" />
    <style>
      .user-profile-header {
        display: flex;
        align-items: center;
        gap: 15px;
        background: rgba(255, 255, 255, 0.1);
        padding: 5px 15px;
        border-radius: 25px;
      }
      .user-balance-box {
        text-align: right;
        line-height: 1.2;
      }
      .user-balance-box span {
        display: block;
        font-size: 11px;
        opacity: 0.9;
        color: #eee;
      }
      .user-balance-box b {
        font-size: 15px;
        color: #fff;
      }
      .user-avatar-circle {
        width: 35px;
        height: 35px;
        background: white;
        color: #b50d0d;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 18px;
      }
      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      /* Style cho nÃºt ThuÃª ngay */
      .btn-link {
        text-decoration: none;
        background: #b50d0d;
        color: white;
        padding: 8px 15px;
        border-radius: 5px;
        font-size: 13px;
        font-weight: bold;
        display: inline-block;
        transition: 0.3s;
      }
      .btn-link:hover {
        background: #8b0a0a;
        transform: scale(1.05);
      }
    </style>
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
        <div class="logo">
          <h1>Há»† THá»NG QUáº¢N LÃ PHÃ’NG TRá»Œ</h1>
        </div>

        <div class="user-profile-header">
  <div class="user-balance-box">
    <span>Sá»‘ dÆ° vÃ­:</span>
    <b id="mainBalance">0Ä‘</b>
  </div>
  <a href="taikhoan.html" style="text-decoration: none; display: flex; align-items: center; gap: 15px;">
    <div class="user-avatar-circle">ğŸ‘¤</div>
    <div class="user-info">
      <strong id="mainUsername" style="color: white">User</strong>
    </div>
  </a>
</div>
    </div>

    <div class="container">
      <aside class="sidebar-nav">
        <h2>DANH Má»¤C</h2>
        <ul>
          <li><a href="trangchu.html" class="active">ğŸ  Danh sÃ¡ch phÃ²ng</a></li>
          <li><a href="thanhtoan.html">ğŸ’° Náº¡p tiá»n Online</a></li>
          <li><a href="hopdong.html">ğŸ“œ Há»£p Ä‘á»“ng</a></li>
          <li><a href="hoadon.html">ğŸ“œ Thanh ToÃ¡n HÃ³a ÄÆ¡n</a></li>
          <li><a href="index.html">ÄÄƒng Xuáº¥t</a></li>
          <li><a href="baocao.html">BÃ¡o CÃ¡o</a></li>
        </ul>
      </aside>

      <main class="main-content">
        <div
          id="liveClock"
          style="margin-bottom: 10px; color: #666; font-size: 14px"
        ></div>
        <div
          id="statSummary"
          class="stat-summary"
          style="
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #b50d0d;
          "
        ></div>

        <table id="roomTable">
  <thead>
    <tr>
      <th>MÃ£ PhÃ²ng</th>
      <th>Loáº¡i PhÃ²ng</th>
      <th>GiÃ¡ ThuÃª</th>
      <th>Tráº¡ng ThÃ¡i</th>
      <th>HÃ nh Äá»™ng</th>
    </tr>
  </thead>
  <tbody id="roomList"></tbody> 
</table>
    </div>

    <div class="footer">
      <p>
        &copy; 2026. Sinh ViÃªn Khoa CNTT TRÆ¯á»œNG Äáº I Há»ŒC NGHá»† AN - Äá» tÃ i: Thiáº¿t
        káº¿ há»‡ thá»‘ng quáº£n lÃ½ nhÃ  trá».
      </p>
    </div>

    <script>
      function syncUserData() {
    const user = localStorage.getItem("registeredUser") || "KhÃ¡ch";
    // Láº¥y sá»‘ dÆ° riÃªng biá»‡t theo tÃªn ngÆ°á»i dÃ¹ng
    const balanceKey = "balance_" + user;
    const balance = parseInt(localStorage.getItem(balanceKey) || 0);
    
    document.getElementById("mainUsername").innerText = user;
    document.getElementById("mainBalance").innerText = balance.toLocaleString("vi-VN") + "Ä‘";
}

function updateTime() {
    const now = new Date();
    const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' };
    document.getElementById("liveClock").innerHTML = "ğŸ•’ " + now.toLocaleDateString("vi-VN", options);
}

function updateStats() {
    let trs = document.querySelectorAll("#roomList tr");
    let total = trs.length;
    let rented = document.querySelectorAll("#roomList tr[data-status='ÄÃ£ thuÃª']").length;
    let empty = total - rented;
    document.getElementById("statSummary").innerHTML = `ğŸ“Š <b>Thá»‘ng kÃª:</b> Tá»•ng ${total} phÃ²ng | ğŸ”´ ÄÃ£ thuÃª: ${rented} | ğŸŸ¢ CÃ²n trá»‘ng: ${empty}`;
}

window.onload = function () {
    syncUserData();
    updateTime();
    setInterval(updateTime, 1000);
    updateStats();
};
    </script>
    

<script src="database.js"></script>
<script>
  function renderGuestRooms() {
    const rooms = getRooms();
    let html = "";
    let rented = 0;

    rooms.forEach((r) => {
      if (r.status === "ÄÃ£ thuÃª") rented++;
      html += `
        <tr data-status="${r.status}">
          <td>${r.id}</td>
          <td>${r.type}</td>
          <td>${r.price.toLocaleString()}Ä‘</td>
          <td><span class="status ${r.status === 'CÃ²n trá»‘ng' ? 'status-empty' : ''}">${r.status}</span></td>
          <td>${r.status === 'CÃ²n trá»‘ng' ? '<a href="formdk.html" class="btn-link">ThuÃª ngay</a>' : '-'}</td>
        </tr>`;
    });
    document.getElementById("roomList").innerHTML = html;
    document.getElementById("statSummary").innerHTML = `ğŸ“Š <b>Thá»‘ng kÃª:</b> Tá»•ng ${rooms.length} phÃ²ng | ğŸ”´ ÄÃ£ thuÃª: ${rented} | ğŸŸ¢ CÃ²n trá»‘ng: ${rooms.length - rented}`;
  }

  function syncUserData() {
    const user = localStorage.getItem("registeredUser") || "KhÃ¡ch";
    const balance = parseInt(localStorage.getItem("balance_" + user) || 0);
    document.getElementById("mainUsername").innerText = user;
    document.getElementById("mainBalance").innerText = balance.toLocaleString("vi-VN") + "Ä‘";
  }

  window.onload = function() {
    syncUserData();
    renderGuestRooms();
    // ThÃªm cÃ¡c hÃ m updateTime() cá»§a báº¡n á»Ÿ Ä‘Ã¢y
  };
</script>

</body>
</html>
  </body>
</html>
